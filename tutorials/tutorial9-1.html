<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring Boot Animal Service Tutorial</title>
    <style>
        body {
            font-family: sans-serif;
            margin: 20px;
            background-color: aliceblue;
        }

        h1,
        h2 {
            color: #333;
        }

        pre {
            background-color: #f4f4f4;
            padding: 10px;
            overflow-x: auto;
        }

        .code {
            font-family: monospace;
        }

        .section {
            margin-bottom: 20px;
        }
        header, footer{
            background-color: rgb(0, 109, 182);
            color: white;
            display: flex;
            align-items: center;            
        }
        header h2{
            color: white;
            padding-left: 5rem;
        }
        footer p{
            padding: 1rem;
        }
    </style>
</head>

<body>
    <header>
        <a class="byuiLogo" title="BYU-Idaho Website" href="https://www.byui.edu"><img src="img/logo.webp"></a>
        <h2>CSE 290R | Applied Programming with Java</h2>
    </header>
    <h1>Spring Boot Animal Service Tutorial</h1>

    <p>This tutorial will guide you through building a RESTful web service using Spring Boot to manage a collection of
        Animal entities.</p>

    <div class="section">
        <h2>1. Project Setup</h2>
        <p>Use Spring Initializr (start.spring.io) or your IDE to create a new Spring Boot project. Add the "Spring Web" dependency.</p>
        <p>ALso include the Apache Commons CSV library in your Maven project, by adding the following dependency to your <code>pom.xml</code> file:</p>
            <pre>
                <code class="code">
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-csv&lt;/artifactId&gt;
        &lt;version&gt;1.10.0&lt;/version&gt;
    &lt;/dependency&gt;
                </code>
            </pre>
    </div>

    <div class="section">
        <h2>2. Project Structure</h2>
        <pre>
animal-service/
├── src/main/java/
│   └── com/example/animalservice/
│       ├── model/
│       │   └── Animal.java
│       ├── service/
│       │   └── AnimalService.java
│       ├── controller/
│       │   └── AnimalController.java
│       └── AnimalServiceApplication.java
├── src/main/resources/
│   ├── application.properties
│   └── animals.csv
└── pom.xml 
        </pre>
    </div>

    <div class="section">
        <h2>3. Animal Model (Animal.java)</h2>
        <pre>
<code class="code">
    package com.example.animalservice.model;

    public class Animal {
        private int id;
        private String name;
        private int age;
        private String diet;
        private String species;
    
        // Constructors, getters, setters, and toString()
        public Animal() {
        }
    
        public Animal(int id, String name, int age, String diet, String species) {
            this.id = id;
            this.name = name;
            this.age = age;
            this.diet = diet;
            this.species = species;
        }
    
        public int getId() {
            return id;
        }
    
        public void setId(int id) {
            this.id = id;
        }
    
        public String getName() {
            return name;
        }
    
        public void setName(String name) {
            this.name = name;
        }
    
        public int getAge() {
            return age;
        }
    
        public void setAge(int age) {
            this.age = age;
        }
    
        public String getDiet() {
            return diet;
        }
    
        public void setDiet(String diet) {
            this.diet = diet;
        }
    
        public String getSpecies() {
            return species;
        }
    
        public void setSpecies(String species) {
            this.species = species;
        }
    
        @Override
        public String toString() {
            return "Animal{" +
                    "id=" + id +
                    ", name='" + name + '\'' +
                    ", age=" + age +
                    ", diet='" + diet + '\'' +
                    ", species='" + species + '\'' +
                    '}';
        }
    }
</code>
        </pre>
    </div>

    <div class="section">
        <h2>4. Animal Service (AnimalService.java)</h2>
        <pre>
<code class="code">
    package com.example.animalservice.service;

    import com.example.animalservice.model.Animal;
    import org.apache.commons.csv.CSVFormat;
    import org.apache.commons.csv.CSVRecord;
    import org.springframework.stereotype.Service;
    import org.springframework.core.io.ClassPathResource;
    
    import java.io.IOException;
    import java.io.InputStreamReader;
    import java.io.Reader;
    import java.util.ArrayList;
    import java.util.List;
    import java.util.stream.Collectors;
    
    @Service
    public class AnimalService {
    
        private final List<Animal> animals = new ArrayList<>();
    
        public AnimalService() {
            loadAnimalsFromCsv();
        }
    
        private void loadAnimalsFromCsv() {
            try {
                ClassPathResource resource = new ClassPathResource("animals.csv");
                Reader reader = new InputStreamReader(resource.getInputStream());
                Iterable<CSVRecord> records = CSVFormat.DEFAULT.withFirstRecordAsHeader().parse(reader);
    
                for (CSVRecord record : records) {
                    int id = Integer.parseInt(record.get("id"));
                    String name = record.get("name");
                    int age = Integer.parseInt(record.get("age"));
                    String diet = record.get("diet");
                    String species = record.get("species");
                    animals.add(new Animal(id, name, age, diet, species));
                }
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    
        public List<Animal> getAllAnimals() {
            return animals;
        }
    
        public Animal getAnimalById(int id) {
            return animals.stream().filter(animal -> animal.getId() == id).findFirst().orElse(null);
        }
    
        public List<Animal> getAnimalsByDiet(String diet) {
            return animals.stream().filter(animal -> animal.getDiet().equalsIgnoreCase(diet)).collect(Collectors.toList());
        }
    
        public List<Animal> searchAnimalsByName(String name) {
            return animals.stream().filter(animal -> animal.getName().toLowerCase().contains(name.toLowerCase())).collect(Collectors.toList());
        }
    
        public void addAnimal(Animal animal) {
            animals.add(animal);
        }
    
        public void removeAnimal(int id) {
            animals.removeIf(animal -> animal.getId() == id);
        }
    }
</code>
        </pre>
        <p>See the previous response for the full code of the AnimalService class.</p>
    </div>

    <div class="section">
        <h2>5. Animal Controller (AnimalController.java)</h2>
        <pre>
<code class="code">
    package com.example.animalservice.controller;

    import com.example.animalservice.model.Animal;
    import com.example.animalservice.service.AnimalService;
    import org.springframework.beans.factory.annotation.Autowired;
    import org.springframework.web.bind.annotation.*;
    
    import java.util.List;
    
    @RestController
    @RequestMapping("/animals")
    public class AnimalController {
    
        @Autowired
        private AnimalService animalService;
    
        @GetMapping
        public List<Animal> getAllAnimals() {
            return animalService.getAllAnimals();
        }
    
        @GetMapping("/{id}")
        public Animal getAnimalById(@PathVariable int id) {
            return animalService.getAnimalById(id);
        }
    
        @GetMapping("/diet/{diet}")
        public List<Animal> getAnimalsByDiet(@PathVariable String diet) {
            return animalService.getAnimalsByDiet(diet);
        }
    
        @GetMapping("/search")
        public List<Animal> searchAnimalsByName(@RequestParam String name) {
            return animalService.searchAnimalsByName(name);
        }
    
        @PostMapping
        public void addAnimal(@RequestBody Animal animal) {
            animalService.addAnimal(animal);
        }
    
        @DeleteMapping("/{id}")
        public void removeAnimal(@PathVariable int id) {
            animalService.removeAnimal(id);
        }
    }
</code>
        </pre>
    </div>

    <div class="section">
        <h2>6. CSV File (animals.csv)</h2>
        <p>Put this CSV file in the src/main/resources folder as shown in the project structure diagram.</p>
        <p><a href="files/animals.csv">animals.csv</a></p>
    </div>

    <div class="section">
        <h2>7. Application Properties (application.properties)</h2>
        <p>No specific properties are needed for this example.</p>
    </div>

    <div class="section">
        <h2>8. Running the Application</h2>
        <p>Run the <code>AnimalServiceApplication</code> using <code>mvn spring-boot:run</code> and test the endpoints
            using Postman or curl.</p>
        <h3>Example Endpoints:</h3>
        <ul>
            <li><code>GET /animals</code>: Get all animals.</li>
            <li><code>GET /animals/1</code>: Get animal with ID 1.</li>
            <li><code>GET /animals/diet/herbivore</code>: Get animals with a herbivore diet.</li>
            <li><code>GET /animals/search?name=lion</code>: Search for animals with "lion" in their name.</li>
            <li><code>POST /animals</code>: Add a new animal (JSON body required). See <a
                    href="files/hyena.json">hyena.json</a> for an example.</li>
            <li><code>DELETE /animals/1</code>: Remove animal with ID 1.</li>
        </ul>
    </div>
    <footer>        
        <p>&copy; 2025 - Brigham Young University, Idaho - All Rights Reserved</p>
    </footer>
</body>

</html>